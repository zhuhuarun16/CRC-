var itIs=[],WhatIsIt=function(){function n(){}return n.itIs=function(t){var u=(new Date).getTime(),i=Shotgun.Js.Charsets.detection(t),r=null;return itIs&&itIs.length>0&&(r=this.checkByPlugin(t,i)),n.elapsed=(new Date).getTime()-u,{isSuccess:i!=Encoder.Unknow||r!=null,message:"ok",chartSet:i,results:r}},n.checkByPlugin=function(n,t){var r=new MemoryStream(n),l=r.bigEndian,o,f,e,i,c,u;r.bigEndian=!0;o=r.getLength()>4?32:r.getLength()*8;switch(o){case 32:f=r.readUInt32();break;case 16:f=r.readUInt16();break;case 8:f=r.readByte();break;default:return null}var a=t==Encoder.Unknow||t==Encoder.Utf16_LE||t==Encoder.Utf16_BE,v=t!=Encoder.Unknow,s=null,h=[];for(e=0;e<itIs.length;e++){i=itIs[e];switch(i.mode){case"text":if(!v)continue;s==null&&(s=Shotgun.Js.Charsets.bytesToString(n,t));break;case"fixedLength":if(n.length!=i.flag)continue;break;default:if(!a)continue;if(i.bits>o)continue;if(c=f>>>32-i.bits,c^i.flag)continue;r.bigEndian=l;r.seek(i.bits/8,1)}u=null;try{u=i.function(i.mode=="text"?s:r)}catch(y){console.error("WhatIsPlugin",i.name,y);continue}if(u!==null&&(u.name||(u.name=i.name),h.push(u),!u.continue))break}return h.length>0?h:null},n.getPluginCount=function(){return itIs?itIs.length:0},n.formatResult=function(t,i){var r={text:"",htmlResult:$("<div><\/div>"),formatted:!1},o=Encoder.Unknow,c=t&&t.isSuccess,s,u,e,l,f,h,a;if(c){if(o=t.chartSet,t.results&&t.results.length!=0)for(s=0;s<t.results.length;s++)if(u=t.results[s],e=$("<div class='pluginResult'><\/div>"),r.htmlResult.append(e),e.append("插件名：【".concat(u.name,"】",u.message,u.continue?"【疑似】":"")),u.canDownload&&(l=this.createUrl(i,u),l!=null&&(f=$("<div>另存为：<\/div>"),f.append(l),r.htmlResult.append(f)),Shotgun.Js.Library.isNullOrEempty(r.text)&&i.length>4096&&(r.text="该内容已经被插件识别为二进制数据。\n但未提供可供阅的文本信息，且数据量较大，故不在此处显示hex内容。\n如需查看hex内容，请关闭自动模式！")),u.resultType&&u.resultType!="none"&&(u.resultType=="html"?(f=$("<div>识别结果：<\/div>"),f.append($(u.result)),r.htmlResult.append(f)):r.text=r.text&&!u.continue?u.result:u.result),u.property){h=[];for(a in u.property)h.push(a.concat(":",u.property[a]));h.length!=0&&(e.append("<div>附加信息：<\/div>"),e.append($("<pre>".concat(h.join("\n"),"<\/pre>"))))}}else r.htmlResult.append("<div class='unknow'>未能识别的数据<\/div>");return r.formatted=!Shotgun.Js.Library.isNullOrEempty(r.text),o==Encoder.Unknow?r.formatted||(r.htmlResult.append($("<div>当前编码：<em class='encoder'>【Hex".concat(c?"":"+Ascii","】<\/em><\/div>"))),r.text=bytesToHex(i,{withAscii:!c})):(r.htmlResult.append($("<div>当前编码：<em class='encoder'>【".concat(Encoder[o],"】<\/em><\/div>"))),r.formatted||(r.text=Shotgun.Js.Charsets.bytesToString(i,o))),r.formatted&&r.htmlResult.append("<div class='formatted'>显示内容非原始信息 ".concat("<span title='插件对此内容进行了格式化、解码或其他调整，如需原始内容请使用非自动模式。'"," class='glyphicon glyphicon-question-sign'><\/span><\/div>")),r.htmlResult.append("<div>数据长度：<em>".concat(i.length.toFixed(),"Byte<\/em>")),r.htmlResult.append("<div class='pluginInfo'>插件总数:<i>".concat(n.getPluginCount().toString(),"<\/i>，识别耗时：<i>",n.elapsed.toString(),"<\/i>ms<\/div>")),r},n.createUrl=function(n,t){var i=document.createElement("a"),r=t.extension?t.extension:".unknow",f;if(i.innerHTML="<b>".concat(r,"文件"),i.download="from_base64@the-x.".concat(r),typeof Uint8Array=="undefined"||typeof URL=="undefined"||!URL.createObjectURL||typeof Blob=="undefined")return i.title="请使用Chrome/Edge/IE10+浏览器",i.href="javascript:void(alert('".concat(i.title,"'));"),console.warn("Uint8Array / URL /Blob 不支持"),i;var e=new Uint8Array(n),o=t.mimeType?t.mimeType:"Application/octet-stream",u=new Blob([e],{type:o});if(!window.navigator.msSaveOrOpenBlob)f=URL.createObjectURL(u),i.href=f;else{$(i).on("click",function(){return window.navigator.msSaveOrOpenBlob(u,i.download)&&!1});i.href="#"}return i},n}();itIs.push({flag:65536,bits:32,name:"TTF","function":function(n){var a,r,e,t,y,i,p,f,u,l;for(n.bigEndian=!0,n.seek(4,1),a=n.readUInt16(),n.seek(12,1),r=0,e=0,i=0;i<a;i++){if(n.readInt32()==1851878757){n.seek(4,0);r=n.readUInt32();e=n.readUInt32();break}n.seek(12,0)}if(r==0||r+e>n.getLength())return null;n.seek(r,1);var o={fSelector:n.readUInt16(),nRCount:n.readUInt16(),storageOffset:n.readUInt16()},v=["Copyright","FamilyName","FontSubfamilyName","UniqueFontIdentifier","FullFontName","Version","PostscriptName","Trademark","Manufacturer","Designer","Description","UrlVendor","UrlDesigner","LicenseDescription","LicenseInfoUrl"],s={},h="Name Table Data("+o.nRCount+")\n".concat(new Array(32).join("="),"\n"),c=[];for(i=0;i<o.nRCount;i++)t={platformID:n.readUInt16(),encodingID:n.readUInt16(),languageID:n.readUInt16(),nameID:n.readUInt16(),stringLength:n.readUInt16(),stringOffset:n.readUInt16()},c.push(t);for(i=0;i<c.length;i++){t=c[i];y=t.nameID>=v.length||t.nameID<0?"Uknow Id:0x".concat(t.nameID.toString(16)):v[t.nameID];p=r+t.stringOffset+o.storageOffset;n.seek(p,1);f=n.readBytes(t.stringLength);l=!0;switch(t.encodingID){case 1:u=Shotgun.Js.Charsets.bytesToString(f,Encoder.Utf16_BE);break;case 0:u=Shotgun.Js.Charsets.bytesToString(f,Encoder.Utf8);break;default:u="#unsupported encoding:".concat(t.encodingID.toString(),"#",bytesToHex(f,{noHead:!0,width:0,spliter:""}));l=!1}(h=h.concat(y,"(LID:",t.languageID.toString(),"): ",u,"\n"),l)&&(t.nameID==4?s.FullName=u:t.nameID==14&&(s.License=u))}return{"continue":!1,message:"True Type Font",extension:"ttf",canDownload:!0,property:s,result:h,resultType:"text"}}});itIs.push({flag:7819078,bits:24,name:"WOFF","function":function(n){var u=n.readByte(),t=1,i,r;if(u==50)t=2;else if(u!=70)return null;return(n.bigEndian=!0,i={Version:"Woff".concat(t.toFixed())},i.SfntVersion=n.readUInt16().toString(16).concat(".",n.readUInt16().toString(16)),r=n.readUInt32(),r!=n.getLength())?(console.log("len",r),null):{"continue":!1,message:"Web Open Font Format V"+t.toString(),extension:"woff".concat(t==1?"":t.toString()),canDownload:!0,property:i}}});itIs.push({flag:65496,bits:16,name:"Jpeg","function":function(n){var i,t=0,r,u,f,e;n.bigEndian=!0;i=n.readUInt16();switch(i){}for(t=n.readUInt16(),r=String.fromCharCode(n.readByte()),r+=String.fromCharCode(n.readByte()),r+=String.fromCharCode(n.readByte()),r+=String.fromCharCode(n.readByte()),console.warn(r),n.seek(t-6,0);!n.endOfStream();){if(u=n.readByte(),u!==255)break;if(i=n.readByte(),i===217||i===218)break;switch(i){case 194:case 192:return t=n.readUInt16(),n.seek(1,0),t=0,f=n.readUInt16(),e=n.readUInt16(),{"continue":!1,message:"Jpeg Image(".concat(r).concat(")"),mimeType:"image/jpeg",extension:"jpg",canDownload:!0,property:{Size:e+"x"+f,foramt:r}};case 196:case 221:case 219:case 224:case 225:t=n.readUInt16()-2;break;default:i>225&&i<239&&(t=n.readUInt16()-2)}t!==0&&(n.seek(t,0),t=0)}return null}});itIs.push({flag:2303741511,bits:32,name:"Png","function":function(n){var t,i,r,u;if(n.bigEndian=!0,t=n.readInt32(),t!==218765834)return null;while(!n.endOfStream()){t=n.readInt32();i=n.readInt32();switch(i){case 1229472850:return r=n.readInt32(),u=n.readInt32(),{"continue":!1,message:"Png Image",mimeType:"image/png",extension:"png",canDownload:!0,property:{Size:r+"x"+u}}}n.seek(t,0)}return null}});itIs.push({flag:1195984440,bits:32,name:"Gif","function":function(n){var t,i,r;return(n.bigEndian=!0,t=n.readUInt16(),t!==14689&&t!==14177)?null:(n.bigEndian=!1,i=n.readUInt16(),r=n.readUInt16(),{"continue":!1,message:"Gif Image",mimeType:"image/gif",extension:"gif",canDownload:!0,property:{Size:i+"x"+r}})}});itIs.push({flag:16973,bits:16,name:"Bmp","function":function(n){var r=n.readUInt32(),t,i;return r!==n.getLength()?null:(n.seek(18,1),t=n.readInt32(),i=n.readInt32(),t<0&&(t=~t+1),i<0&&(i=~i+1),{"continue":!1,message:"Bmp Image",mimeType:"image/bmp",extension:"bmp",canDownload:!0,property:{Size:t+"x"+i}})}});itIs.push({bits:0,flag:0,name:"JSON",mode:"text","function":function(n){var t,f;if(typeof JSON=="undefined")return null;for(var i=0,r=0,u=null;i<n.length;i++){t=n.charAt(i);switch(t){case"\n":case"\r":case"\t":case" ":continue;case"[":case"{":u=String.fromCharCode(t.charCodeAt(0)+2);break;default:return null}break}if(u==null)return null;for(i++,r=n.length-1;r>i;r--){t=n.charAt(r);switch(t){case"\n":case"\r":case"\t":case" ":continue;case"]":case"}":if(t==u)break;default:return null}break}f=null;try{f=JSON.parse(n)}catch(r){return console.warn("Not Json Result",r),null}return{message:"",result:JSON.stringify(f,null,2),resultType:"text","continue":!1}}});itIs.push({bits:0,flag:0,name:"XML",mode:"text","function":function(n){function y(n){for(var i,r=[],u=n.attributes,t=0;t<u.length;t++)i=u[t],r.push(i.name.concat('="',a(i.value),'"'));return r.join(" ")}function a(n){var t,i,r;if(Shotgun.Js.Library.isNullOrEempty(n))return n;for(t=[],i=0;i<n.length;i++){r=n.charAt(i);switch(r){case"<":t.push("&lt;");break;case">":t.push("&gt;");break;case'"':t.push("&quot;");break;case"'":t.push("&apos;");break;case"&":t.push("&amp;");break;default:t.push(r)}}return t.join("")}function v(n,t,i){var e,o;if(n.nodeType!=3){if(n.nodeType==4){i.push(r.concat(u,"<![CDATA[",n.firstChild.nodeValue,"]\]>"));return}var r=new Array(t*2+1).join(" "),f=n.nodeName,u="<".concat(f);if(n.hasAttributes()&&(u+=" ".concat(y(n))),!n.hasChildNodes()){i.push(r.concat(u,"/>"));return}if(n.firstChild.nodeType==3&&n.childNodes.length==1){i.push(r.concat(u,">",a(n.firstChild.nodeValue),"<\/",f,">"));return}if(n.firstChild.nodeType==4){i.push(r.concat(u,"><![CDATA[",n.firstChild.nodeValue,"]\]><\/",f,">"));return}for(i.push(r.concat(u,">")),e=0;e<n.childNodes.length;e++)o=n.childNodes[e],v(o,t+1,i);i.push(r.concat("<\/",f,">"))}}var t,r,u,f,h,i,e,c,s,l,o;if(typeof DOMParser=="undefined"||typeof XMLSerializer=="undefined"||n.length<10)return null;for(t=0,r=-1;t<n.length;t++){f=n.charAt(t);switch(f){case"\n":case"\r":case"\t":case" ":continue;case"<":break;default:return null}break}for(n.charAt(t+1)=="?"&&(r=t),u=n.length-1;u>t;u--){f=n.charAt(u);switch(f){case"\n":case"\r":case"\t":case" ":continue;case">":break;default:return null}break}h=new DOMParser;i=null;try{i=h.parseFromString(n,"text/xml")}catch(u){return console.warn("Not Xml Result",u),null}return i==null?null:(e=i.getElementsByTagName("parsererror"),e.length==1&&((c=e[0],c.hasAttribute("style"))||(s=n.lastIndexOf("<\/"),s==-1)||(l=/(\w.+?)(>|\s)/.exec(n.substr(s))[1],i.firstChild.nodeName!=l)))?(console.warn("xml error",$(e[0]).text()),null):(o=[],r!=-1&&(t=n.indexOf("?>",r),o.push(n.substring(r,t+2))),v(i.firstChild,0,o),{message:"","continue":!1,result:o.join("\n"),resultType:"text"})}});itIs.push({bits:32,flag:4,name:"Integer",mode:"fixedLength","function":function(n){var t,r,i;return(n.seek(0,1),n.bigEndian=!1,t=n.readInt32(),t==0)?null:(n.seek(0,1),n.bigEndian=!0,r=n.readInt32(),i={"continue":!0,message:"May be an Integer.",property:{"BigEndian-Int32":r}},r<0&&(i.property["BigEndian-UInt32"]=r>>>0),i.property["LittleEndian-Int32"]=t,t<0&&(i.property["LittleEndian-UInt32"]=t>>>0),i)}});itIs.push({bits:16,flag:2,name:"Int16",mode:"fixedLength","function":function(n){var t,r,i;return(n.seek(0,1),n.bigEndian=!1,t=n.readUInt16(),t==0)?null:(n.seek(0,1),n.bigEndian=!0,r=n.readUInt16(),i={"continue":!0,message:"May be a Short Integer(Int16).",property:{"BigEndian-Int16":r}},i.property["LittleEndian-Int16"]=t,i)}});itIs.push({flag:3104,bits:14,name:"PEM(PrivateKey)",getIntegerSize:function(n){var t=0,i=0;return(t=n.readByte(),t!=2)?0:(t=n.readByte(),i=t==129?n.readByte():t==130?n.readByte()<<8|n.readByte():t,n.readByte()==0&&i--,i)},getRSAPrivateKeyPKCS1:function(n,t){var i=n.readUInt16(),u,r;if(i==33072)n.position++;else if(i==33328)n.position+=2;else return null;return(i=n.readUInt16(),i!=258)?null:(u=n.readByte(),u!=0)?null:(r=this.getIntegerSize(n),r===0)?null:{"continue":!1,message:"PEM Private Key",property:{KeySize:(r*8).toString().concat("Bits"),KeyType:"Private Key + Public Key",Format:t>0?"PKCS8":"PKCS1"}}},"function":function(n){var u=[48,13,6,9,42,134,72,134,247,13,1,1,1,5,0],i,t,f,r;if(n.seek(0,1),i=n.readUInt16(),i==33072)n.position++;else if(i==33328)n.position+=2;else return null;if((t=n.readByte(),t!=2)||(i=n.readUInt16(),i!=1))return null;if(f=n.readInt32(),f!=151391536)return n.seek(0,1),this.getRSAPrivateKeyPKCS1(n,0);for(r=4;r<u.length;r++)if(n.readByte()!=u[r])return null;return(t=n.readByte(),t!=4)?null:(t=n.readByte(),t==129?n.position++:t==130&&(n.position+=2),this.getRSAPrivateKeyPKCS1(n,n.position))}});itIs.push({flag:3104,bits:14,name:"PEM(PublicKey)","function":function(n){var f=[48,13,6,9,42,134,72,134,247,13,1,1,1,5,0],u,t,r,i;if(n.seek(0,1),u=0,t=0,t=n.readUInt16(),t==33072)n.position++;else if(t==33328)n.position+=2;else return;for(r=0;r<f.length;r++)if(n.readByte()!=f[r])return null;if(t=n.readUInt16(),t==33027)n.position++;else if(t==33283)n.position++;else return null;if(u=n.readByte(),u!=0)return null;if(t=n.readUInt16(),t==33072)n.position++;else if(t==33328)n.position+=2;else if(t!=18480)return null;if(i=0,t=n.readUInt16(),t==33026)i=n.readByte();else if(t==33282)i=n.readUInt16();else return null;return i===0?null:(n.readByte()==0&&i--,{"continue":!1,message:"PEM Public Key",property:{KeyType:"Public Key",KeySize:(i*8).toString().concat("Bits"),Format:"PKCS8"}})}});itIs.push({bits:0,flag:0,name:"UrlEncoder",mode:"text","function":function(n){var r=/\%[a-f0-9]{1,2}/ig,i=r.exec(n),t;if(i==null)return null;do if(i[0].length!=3)return null;while(i=r.exec(n));return t=document.createElement("a"),t.innerHTML="UrlDecode Tools",t.href="/UrlDecode.aspx",t.target="_blank",{message:"Urlencode may have been used.","continue":!0,resultType:"html",result:t}}});itIs.push({flag:2067208,bits:24,name:"Gzip",mode:"stream","function":function(n){var f,u,t,i,r,e;return n.getLength()<16?null:(f=n.readByte(),(f&224)!=0)?null:(u=n.readUInt32(),t=n.readByte(),t!==2&&t!==4&&t!==0)?null:(i={"continue":!1,mimeType:"application/x-gzip",message:"Gzip compressed data",extension:"z",canDownload:!0,property:{eXtraFLags:t}},u!==0&&(i.property.SystemTime=new Date(u*1e3).toLocaleString()),r=n.readByte(),i.property.OperatingSystem=r>14?r+"-Unknow":["0-FAT filesystem(MS-DOS,OS/2,NT/Win32)","1-Amiga","2-VMS(orOpenVMS)","3-Unix","4-VM/CMS","5-Atari TOS","6-HPFS filesystem(OS/2,NT)","7-Macintosh","8-Z-System","9-CP/M","10-TOPS-20","11-NTFS filesystem(NT)","12-QDOS","13-Acorn RISCOS","14-VFAT file system (Win95, NT)","15-MVS or PRIMOS","16-BeOS","17-Tandem/NSK","18-THEOS","19-macOS,,OS/X,iOS or watchOS"][r],n.seek(-4,2),e=n.readUInt32(),i.property.DataSize=Shotgun.Js.Library.byteSize(e).concat("Byte"),i)}});itIs.push({flag:1347093252,bits:32,name:"Zip","function":function(n){var t,i;if(!this.getZipInfo(n))return null;var r=this.getCdInfo(n),f={Encrypted:this.isEncrypted,Files:r.length,"Total Size":0},u="Zip Data Incluce:\n".concat(new Array(18).join("-"),"\n"),e=0;for(t=0;t<r.length;t++)i=r[t],e+=i.size,u=u.concat(Shotgun.Js.Library.byteSize(i.size),"Byte\t",i.name,"\n");return f["Total Size"]=e,{property:f,message:"Zip-based or zip file",resultType:"text",result:u,"continue":!1,canDownload:!0,extension:"zip"}},convertZipDate:function(n,t){var r=new Date,i;return n==0?r:(i=t,r.setSeconds((i&31)<<2),i>>=5,r.setMinutes(i&63),i>>=6,r.setHours(i),i=n,r.setDate(i&31),i>>=5,r.setMonth(i&14),i>>=4,r.setFullYear(i+1980),r)},getZipInfo:function(n){var r,t,u,i;n.seek(-22,2);t=n.position-65570;t<0&&(t=64);do{if(r=n.readUInt32(),r==101010256)break;n.seek(-5,0)}while(n.position>t);if(n.position<=32)return!1;if(n.seek(6,0),this.numOfCd=n.readUInt16(),u=n.readUInt32(),this.posOfCd=n.readUInt32(),u+this.posOfCd>n.getLength())return console.warn("sizeOfCd+this.posOfCd>stm.getLength()"),!1;if(i=n.readUInt16(),i>0){if(i+n.position>n.getLength())return!1;this.zipComment=Shotgun.Js.Charsets.fromGB2312Bytes(n.readBytes(i))}return this.numOfCd>0&&this.posOfCd>0},getCdInfo:function(n){var e,r,u,t,i,o,f,s;for(n.seek(this.posOfCd,1),e=33639248,r=[],u=0;u<this.numOfCd;u++){if(t=n.readUInt32(),t!=e)return null;n.seek(4,0);t=n.readUInt16();t&1?this.isEncrypted=!0:t&64&&(this.isEncrypted=!0);i={};n.seek(2,0);o=n.readUInt16();t=n.readUInt16();i.lastWrited=this.convertZipDate(t,o);n.seek(8,0);i.size=n.readUInt32();t=n.readUInt16();f=n.readUInt16();f+=n.readUInt16();n.seek(12,0);s=n.readBytes(t);i.name=Shotgun.Js.Charsets.fromGB2312Bytes(s);r.push(i);n.seek(f,0)}return r},zipComment:null,numOfCd:0,posOfCd:0,isEncrypted:!1});